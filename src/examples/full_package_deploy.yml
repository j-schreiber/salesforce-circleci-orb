description: >
  A job that builds a release candidate asynchronously, performs simple scratch org validation and
  deploys an unvalidated package to a sandbox. After an approval step, the release candidate is
  promoted and deployed to production.

usage:
  version: 2.1
  orbs:
    jsc-sfdx: jsc/salesforce@0.4.0

  parameters:
    username-prod:
      description: Username of a Production/DevHub environment
      type: string
      default: admin@your-domain.de
    username-uat:
      description: Username of a Sandbox
      type: string
      default: admin@your-domain.de.uat

  jobs:
    testing_job:
      docker:
        - image: cimg/base:stable
      steps:
        - checkout
        - jsc-sfdx/install
        - jsc-sfdx/auth:
            username: << pipeline.parameters.username-prod >>
            instanceUrl: https://jl-consulting-dev-ed.my.salesforce.com
            jwtKey: TEST_JWT_KEY
            consumerKey: TEST_CONSUMER_KEY
            setDefault: true
